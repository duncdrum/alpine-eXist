sudo: required
dist: trusty
os: linux
language: c
services:
  - docker
env:
  global:
    - IMAGE="grantmacken/alpine-exist"
before_script:
  - docker pull "$IMAGE" || true
script:
  - docker build --pull --cache-from "$IMAGE" --tag "$IMAGE" .
  - docker run --name ex --publish 8080:8080 -d $IMAGE
  - docker ps
  - docker exec ex ls .
  - docker exec ex which java
  - docker exec ex java -jar start.jar client -u admin -P 'admin' -q -x 'system:get-version()'

after_script:
- docker images
